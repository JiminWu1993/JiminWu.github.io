<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>英语时态之旅</title>
    <style>
        /* 基础样式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }
        
        body {
            background-color: black;
            color: white;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        /* 游戏容器 */
        #game-container {
            width: 100%;
            height: 100%;
            position: relative;
            display: flex;
            flex-direction: column;
        }
        
        /* 页面样式 */
        .page {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            display: none;
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }
        
        .page.active {
            display: flex;
            opacity: 1;
        }
        
        /* 图片样式 */
        .page-image {
            width: 100%;
            object-fit: cover;
        }
        
        /* 文字内容样式 */
        .text-content {
            background-color: rgba(0, 0, 0, 0.7);
            padding: 15px;
            font-size: 18px;
            line-height: 1.5;
            text-align: center;
        }
        
        /* 按钮容器样式 */
        .buttons-container {
            display: flex;
            flex-direction: column;
            padding: 10px;
            gap: 10px;
            flex-grow: 1;
            justify-content: flex-start;
            overflow-y: auto;
        }
        
        .button-row {
            display: flex;
            justify-content: space-around;
            width: 100%;
            gap: 5px;
        }
        
        /* 选项按钮样式 */
        .option-btn {
            flex: 1;
            padding: 12px 5px;
            background-color: #1E90FF;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            min-height: 50px;
            opacity: 0.7;
        }
        
        .option-btn.selected {
            opacity: 1;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        /* Continue按钮样式 */
        .continue-btn {
            width: 100%;
            padding: 15px;
            background-color: #1E90FF;
            color: white;
            border: none;
            font-size: 18px;
            cursor: pointer;
            margin-top: auto;
        }
        
        /* 提示框样式 */
        .alert-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: blue;
            color: white;
            padding: 20px;
            border-radius: 10px;
            z-index: 1000;
            text-align: center;
            display: none;
        }
        
        /* 得分页面样式 */
        .score-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .score-image {
            width: 100%;
            max-height: 50%;
            object-fit: contain;
        }
        
        .score-text {
            font-size: 24px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- 开始画面 -->
        <div id="page-2100" class="page">
            <img src="images/开始画面.jpg" alt="开始画面" class="page-image">
            <div class="text-content">Welcome to the journey of English tenses</div>
            <div class="buttons-container">
                <div class="button-row">
                    <button class="option-btn" onclick="switchPage(2101)">Begin</button>
                </div>
            </div>
        </div>

        <!-- 游戏页面将动态生成 -->
        
        <!-- 提示框 -->
        <div id="alert-box" class="alert-box"></div>
    </div>

    <script>
        // 游戏数据
        const gameData = [
            {
                id: 2100,
                image: "开始画面.jpg",
                text: "Welcome to the journey of English tenses",
                buttons: [
                    { content: "Begin", target: 2101 }
                ]
            },
            {
                id: 2101,
                image: "画面01.jpg",
                text: "Arturo: Hello, I'm Arturo Valdez.",
                buttons: [],
                continueTarget: 2102
            },
            {
                id: 2102,
                image: "画面02.jpg",
                text: "Alexa: Hi. My name (1) Alexandra Costa, but please (2) me Alexa.",
                buttons: [
                    [
                        { id: "1-1", content: "is", correct: true },
                        { id: "1-2", content: "am", correct: false },
                        { id: "1-3", content: "are", correct: false }
                    ],
                    [
                        { id: "2-1", content: "calls", correct: false },
                        { id: "2-2", content: "call", correct: true },
                        { id: "2-3", content: "calling", correct: false }
                    ]
                ],
                continueTarget: 2103
            },
            {
                id: 2103,
                image: "画面03.jpg",
                text: "Arturo: OK. Where (3) you from, Alexa?",
                buttons: [
                    [
                        { id: "3-1", content: "is", correct: false },
                        { id: "3-2", content: "are", correct: true },
                        { id: "3-3", content: "am", correct: false }
                    ]
                ],
                continueTarget: 2104
            },
            {
                id: 2104,
                image: "画面04.jpg",
                text: "Alexa: Brazil. How about you?",
                buttons: [],
                continueTarget: 2105
            },
            {
                id: 2105,
                image: "画面05.jpg",
                text: "Arturo: I'm from Mexico. I (4) here in the city now, but my family (5) in a small town near Guadalajara.",
                buttons: [
                    [
                        { id: "4-1", content: "lives", correct: true },
                        { id: "4-2", content: "live", correct: false },
                        { id: "4-3", content: "living", correct: false }
                    ],
                    [
                        { id: "5-1", content: "lives", correct: true },
                        { id: "5-2", content: "live", correct: false },
                        { id: "5-3", content: "are living", correct: false }
                    ]
                ],
                continueTarget: 2106
            },
            {
                id: 2106,
                image: "画面06.jpg",
                text: "Alexa: Oh, I (6) Mexico! It (7) really beautiful. My brother (8) Mexico, too. Oh, good. Soo-jin (9) here.",
                buttons: [
                    [
                        { id: "6-1", content: "loves", correct: false },
                        { id: "6-2", content: "love", correct: true },
                        { id: "6-3", content: "loving", correct: false }
                    ],
                    [
                        { id: "7-1", content: "is", correct: true },
                        { id: "7-2", content: "am", correct: false },
                        { id: "7-3", content: "are", correct: false }
                    ],
                    [
                        { id: "8-1", content: "loves", correct: true },
                        { id: "8-2", content: "love", correct: false },
                        { id: "8-3", content: "loving", correct: false }
                    ],
                    [
                        { id: "9-1", content: "is", correct: true },
                        { id: "9-2", content: "are", correct: false },
                        { id: "9-3", content: "am", correct: false }
                    ]
                ],
                continueTarget: 2107
            },
            {
                id: 2107,
                image: "画面07.jpg",
                text: "Arturo: Who (10) Soo-jin? She (11) familiar.",
                buttons: [
                    [
                        { id: "10-1", content: "is", correct: true },
                        { id: "10-2", content: "are", correct: false },
                        { id: "10-3", content: "am", correct: false }
                    ],
                    [
                        { id: "11-1", content: "looks", correct: true },
                        { id: "11-2", content: "look", correct: false },
                        { id: "11-3", content: "looking", correct: false }
                    ]
                ],
                continueTarget: 2108
            },
            {
                id: 2108,
                image: "画面08.jpg",
                text: "Alexa: She (12) my classmate. We (13) in the same business class. We (14) our class every Monday and Wednesday.",
                buttons: [
                    [
                        { id: "12-1", content: "is", correct: false },
                        { id: "12-2", content: "are", correct: true },
                        { id: "12-3", content: "am", correct: false }
                    ],
                    [
                        { id: "13-1", content: "is", correct: false },
                        { id: "13-2", content: "are", correct: true },
                        { id: "13-3", content: "am", correct: false }
                    ],
                    [
                        { id: "14-1", content: "has", correct: false },
                        { id: "14-2", content: "have", correct: true },
                        { id: "14-3", content: "having", correct: false }
                    ]
                ],
                continueTarget: 2109
            },
            {
                id: 2109,
                image: "画面09.jpg",
                text: "Arturo: Where (15) she from?",
                buttons: [
                    [
                        { id: "15-1", content: "is", correct: false },
                        { id: "15-2", content: "are", correct: true },
                        { id: "15-3", content: "am", correct: false }
                    ]
                ],
                continueTarget: 2110
            },
            {
                id: 2110,
                image: "画面10.jpg",
                text: "Alexa: South Korea. She (16) marketing. She (17) the classes (18) very interesting. Let's go and say hello. Sorry, what (19) your last name again? Vargas?",
                buttons: [
                    [
                        { id: "16-1", content: "studies", correct: true },
                        { id: "16-2", content: "study", correct: false },
                        { id: "16-3", content: "studying", correct: false }
                    ],
                    [
                        { id: "17-1", content: "says", correct: true },
                        { id: "17-2", content: "say", correct: false },
                        { id: "17-3", content: "saying", correct: false }
                    ],
                    [
                        { id: "18-1", content: "is", correct: false },
                        { id: "18-2", content: "are", correct: true },
                        { id: "18-3", content: "am", correct: false }
                    ],
                    [
                        { id: "19-1", content: "is", correct: true },
                        { id: "19-2", content: "are", correct: false },
                        { id: "19-3", content: "am", correct: false }
                    ]
                ],
                continueTarget: 2111
            },
            {
                id: 2111,
                image: "画面11.jpg",
                text: "Arturo: Actually, it (20) Valdez",
                buttons: [
                    [
                        { id: "20-1", content: "is", correct: true },
                        { id: "20-2", content: "are", correct: false },
                        { id: "20-3", content: "am", correct: false }
                    ]
                ],
                continueTarget: 2112
            },
            {
                id: 2112,
                image: "画面12.jpg",
                text: "Alexa: How (21) you spell that?",
                buttons: [
                    [
                        { id: "21-1", content: "is", correct: false },
                        { id: "21-2", content: "are", correct: true },
                        { id: "21-3", content: "am", correct: false }
                    ]
                ],
                continueTarget: 2113
            },
            {
                id: 2113,
                image: "画面13.jpg",
                text: "My name's Nick. My girlfriend's name (1) Karen. We (2) students. I (3) to university in Oxford.",
                buttons: [
                    [
                        { id: "22-1", content: "is", correct: true },
                        { id: "22-2", content: "are", correct: false },
                        { id: "22-3", content: "am", correct: false }
                    ],
                    [
                        { id: "23-1", content: "is", correct: false },
                        { id: "23-2", content: "are", correct: true },
                        { id: "23-3", content: "am", correct: false }
                    ],
                    [
                        { id: "24-1", content: "go", correct: true },
                        { id: "24-2", content: "goes", correct: false },
                        { id: "24-3", content: "going", correct: false }
                    ]
                ],
                continueTarget: 2114,
                scoring: true
            },
            {
                id: 2114,
                image: "画面14.jpg",
                text: "Karen (4) go to university in Oxford; she (5) to university in Cambridge. She (6) in Cambridge.",
                buttons: [
                    [
                        { id: "25-1", content: "don't", correct: false },
                        { id: "25-2", content: "isn't", correct: false },
                        { id: "25-3", content: "doesn't", correct: true }
                    ],
                    [
                        { id: "26-1", content: "go", correct: false },
                        { id: "26-2", content: "goes", correct: true },
                        { id: "26-3", content: "going", correct: false }
                    ],
                    [
                        { id: "27-1", content: "lives", correct: true },
                        { id: "27-2", content: "live", correct: false },
                        { id: "27-3", content: "living", correct: false }
                    ]
                ],
                continueTarget: 2115,
                scoring: true
            },
            {
                id: 2115,
                image: "画面15.jpg",
                text: "I (7) with my parents in Woodstock, which (8) a small town near Oxford.",
                buttons: [
                    [
                        { id: "28-1", content: "lives", correct: false },
                        { id: "28-2", content: "live", correct: true },
                        { id: "28-3", content: "living", correct: false }
                    ],
                    [
                        { id: "29-1", content: "is", correct: true },
                        { id: "29-2", content: "are", correct: false },
                        { id: "29-3", content: "am", correct: false }
                    ]
                ],
                continueTarget: 2116,
                scoring: true
            },
            {
                id: 2116,
                image: "画面16.jpg",
                text: "It (9) difficult sometimes because we (10) each other only on weekends.",
                buttons: [
                    [
                        { id: "30-1", content: "is", correct: true },
                        { id: "30-2", content: "are", correct: false },
                        { id: "30-3", content: "am", final: false }
                    ],
                    [
                        { id: "31-1", content: "see", correct: true },
                        { id: "31-2", content: "sees", correct: false },
                        { id: "31-3", content: "seeing", correct: false }
                    ]
                ],
                continueTarget: 2117,
                scoring: true
            },
            {
                id: 2117,
                image: "画面17.jpg",
                text: "Karen (11) history, and she (12) her course. She (13) the architecture in Cambridge (14) beautiful.",
                buttons: [
                    [
                        { id: "32-1", content: "studies", correct: true },
                        { id: "32-2", content: "study", correct: false },
                        { id: "32-3", content: "studying", correct: false }
                    ],
                    [
                        { id: "33-极简", content: "love", correct: false },
                        { id: "33-2", content: "loves", correct: true },
                        { id: "33-3", content: "loving", correct: false }
                    ],
                    [
                       极简 { id: "34-1", content: "says", correct: true },
                        { id: "34-2", content: "say", correct: false },
                        { id: "34-3", content: "saying", correct: false }
                    ],
                    [
                        { id: "35-1", content: "is", correct: true },
                        { id: "35-2", content: "are", correct: false },
                        { id: "35-3", content: "am", correct: false }
                    ]
                ],
                continueTarget: 2118,
                scoring: true
            },
            {
                id: 2118,
                image: "画面18.jpg",
                text: "I (15) philosophy and politics, so my courses (16) very different from hers.",
                buttons: [
                    [
                        { id: "36-1", content: "studies", correct: false },
                        { id极: "36-2", content: "study", correct: true },
                        { id: "36-3", content: "studying", correct: false }
                    ],
                    [
                        { id: "37-1", content: "is", correct: false },
                        { id: "37-2", content: "are", correct: true },
                        { id: "37-3", content: "am", correct: false }
                    ]
                ],
                continueTarget: 2119,
                scoring: true
            },
            {
                id: 2119,
                image: "画面19.jpg",
                text: "I (17) living in Woodstock because my family (18) there and it (19) quiet, but I (20) Karen a lot.",
                buttons: [
                    [
                        { id: "38-1", content: "like", correct: true },
                        { id: "38-2", content: "likes", correct: false },
                        { id: "38-3", content: "liking", correct: false }
                    ],
                    [
                        { id: "39-1", content:极 "is", correct: true },
                        { id: "39-2", content: "are", correct: false },
                        { id: "39-3", content: "am", correct: false }
                    ],
                    [
                        { id: "40-1", content: "is", correct: true },
                        { id: "40-2", content: "are", correct: false },
                        { id: "40-3", content: "am", correct: false }
                    ],
                    [
                        { id: "41-1", content: "miss", correct: true },
                        { id: "41-2", content: "misses", correct: false },
                        { id: "41-3", content: "missing", correct: false }
                    ]
                ],
                continueTarget: 2120,
                scoring: true
            },
            {
                id: 2120,
                image: "画面20.jpg",
                text: "We (21) on the phone every night and we (22) each other whenever we can.",
                buttons: [
                    [
                        { id: "42-1", content: "talk", correct: true },
                        { id: "42-2", content: "talks", correct: false },
                        { id: "42-3", content: "talking", correct: false }
                    ],
                    [
                        { id: "43-1", content: "visit", correct: true },
                        { id: "43-2", content: "visits", correct: false },
                        { id: "43-3", content: "visiting", correct: false }
                    ]
                ],
                continueTarget: 2121,
                scoring: true
            },
            {
                id: 2121,
                scoringPage: true
            }
        ];

        // 游戏状态
        let currentPageId = 2100;
        let score = 0;
        let selectedAnswers = {};
        let preloadedImages = {};

        // 初始化游戏
        function initGame() {
            // 创建所有游戏页面
            createGamePages();
            
            // 预加载第一张图片
            preloadNextImage(2100);
            
            // 显示开始页面
            switchPage(2100);
            
            // 添加事件监听器
            document.addEventListener('click', handleButtonClick);
        }

        // 创建所有游戏页面
        function createGamePages() {
            const gameContainer = document.getElementById('game-container');
            
            gameData.forEach(pageData => {
                if (pageData.id === 2100) return; // 开始页面已存在
                
                if (pageData.scoringPage) {
                    // 创建得分页面
                    const scorePage = document.createElement('div');
                    scorePage.id = `page-${pageData.id}`;
                    scorePage.className = 'page score-page';
                    gameContainer.appendChild(scorePage);
                    return;
                }
                
                const page = document.createElement('div');
                page.id = `page-${pageData.id}`;
                page.className = 'page';
                
                // 添加图片
                const img = document.createElement('img');
                img.src = `images/${pageData.image}`;
                img.alt = pageData.image;
                img.className = 'page-image';
                page.appendChild(img);
                
                // 添加文本内容
                const textDiv = document.createElement('div');
                textDiv.className = 'text-content';
                textDiv.textContent = pageData.text;
                page.appendChild(textDiv);
                
                // 添加按钮容器
                const buttonsContainer = document.createElement('div');
                buttonsContainer.className = 'buttons-container';
                
                // 添加选项按钮
                pageData.buttons.forEach((buttonRow, rowIndex) => {
                    const rowDiv = document.createElement('div');
                    rowDiv.className = 'button-row';
                    
                    buttonRow.forEach(button => {
                        const btn = document.createElement('button');
                        btn.className = 'option-btn';
                        btn.textContent = button.content;
                        btn.dataset.id = button.id;
                        btn.dataset.correct = button.correct;
                        rowDiv.appendChild(btn);
                    });
                    
                    buttonsContainer.appendChild(rowDiv);
                });
                
                page.appendChild(buttonsContainer);
                
                // 添加Continue按钮
                if (pageData.continueTarget) {
                    const continueBtn = document.createElement('button');
                    continueBtn.className = 'continue-btn';
                    continueBtn.textContent = 'Continue';
                    continueBtn.dataset.target = pageData.continueTarget;
                    page.appendChild(continueBtn);
                }
                
                gameContainer.appendChild(page);
            });
        }

        // 切换页面
        function switchPage(pageId) {
            // 隐藏当前页面
            const currentPage = document.getElementById(`page-${currentPageId}`);
            if (currentPage) {
                currentPage.classList.remove('active');
            }
            
            // 更新当前页面ID
            currentPageId = pageId;
            
            // 显示新页面
            const newPage = document.getElementById(`page-${pageId}`);
            if (newPage) {
                newPage.classList.add('active');
                
                // 预加载下一张图片
                const nextPageData = gameData.find(page => page.id === pageId + 1);
                if (nextPageData && nextPageData.image) {
                    preloadNextImage(pageId + 1);
                }
            }
            
            // 如果是得分页面，计算并显示得分
            if (pageId === 2121) {
                showScore();
            }
        }

        // 预加载图片
        function preloadNextImage(nextPageId) {
            const nextPageData = gameData.find(page => page.id === nextPageId);
            if (!nextPageData || !nextPageData.image || preloadedImages[nextPageId]) {
                return;
            }
            
            const img = new Image();
            img.src = `images/${nextPageData.image}`;
            img.onload = function() {
                preloadedImages[nextPageId] = true;
            };
            img.onerror = function() {
                console.error(`Failed to preload image: images/${nextPageData.image}`);
            };
        }

        // 处理按钮点击
        function handleButtonClick(event) {
            const target = event.target;
            
            if (target.classList.contains('option-btn')) {
                // 处理选项按钮点击
                handleOptionClick(target);
            } else if (target.classList.contains('continue-btn')) {
                // 处理Continue按钮点击
                handleContinueClick(target);
            }
        }

        // 处理选项按钮点击
        function handleOptionClick(button) {
            const buttonId = button.dataset.id;
            const rowId = buttonId.split('-')[0];
            const pageId = currentPageId;
            
            // 取消同行其他按钮的选中状态
            const sameRowButtons = document.querySelectorAll(`#page-${pageId} .option-btn[data-id^="${rowId}-"]`);
            sameRowButtons.forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // 设置当前按钮为选中状态
            button.classList.add('selected');
            
            // 存储答案
            if (!selectedAnswers[pageId]) {
                selectedAnswers[pageId] = {};
            }
            selectedAnswers[pageId][rowId] = {
                id: buttonId,
                correct: button.dataset.correct === 'true'
            };
        }

        // 处理Continue按钮点击
        function handleContinueClick(button) {
            const targetPageId = parseInt(button.dataset.target);
            const currentPageData = gameData.find(page => page.id === currentPageId);
            
            // 检查是否所有必选按钮都已选择
            if (currentPageData.buttons && currentPageData.buttons.length > 0) {
                let allSelected = true;
                
                for (let i = 0; i < currentPageData.buttons.length; i++) {
                    const rowId = currentPageData.buttons[i][0].id.split('-')[0];
                    if (!selectedAnswers[currentPageId] || !selectedAnswers[currentPageId][rowId]) {
                        allSelected = false;
                        break;
                    }
                }
                
                if (!allSelected) {
                    showAlert('请完成所有选择后再继续');
                    return;
                }
            }
            
            // 如果是计分页面，计算得分
            if (currentPageData.scoring) {
                calculateScoreForCurrentPage();
            }
            
            // 切换页面
            switchPage(targetPageId);
        }

        // 计算当前页面得分
        function calculateScoreForCurrentPage() {
            const pageAnswers = selectedAnswers[currentPageId];
            if (!pageAnswers) return;
            
            Object.values(pageAnswers).forEach(answer => {
                if (answer.correct) {
                    score++;
                }
            });
        }

        // 显示提示框
        function showAlert(message) {
            const alertBox = document.getElementById('alert-box');
            alertBox.textContent = message;
            alertBox.style.display = 'block';
            
            setTimeout(() => {
                alertBox.style.display = 'none';
            }, 2000);
        }

        // 显示得分
        function showScore() {
            const scorePage = document.getElementById('page-2121');
            scorePage.innerHTML = '';
            
            // 计算总分
            const totalScore = Math.floor(score * (100 / 22));
            
            // 选择图片
            const img = document.createElement('img');
            img.className = 'score-image';
            img.src = `images/${totalScore >= 60 ? '及格.jpg' : '不及格.jpg'}`;
            img.alt = totalScore >= 60 ? '及格' : '不及格';
            
            // 创建得分文本
            const scoreText = document.createElement('div');
            scoreText.className = 'score-text';
            scoreText.textContent = `得分: ${totalScore}`;
            
            // 添加到页面
            scorePage.appendChild(img);
            scorePage.appendChild(scoreText);
        }

        // 页面加载完成后初始化游戏
        window.addEventListener('load', initGame);
    </script>
</body>
</html>
